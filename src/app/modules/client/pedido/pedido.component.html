<div class="page-shell">
  <div class="pedido-detalle-container">
    <!-- Header -->
    <header class="pedido-detalle-header">
      <h1 class="section-title">Detalle del Pedido</h1>
    </header>

    <!-- Loading State -->
    @if (loading) {
      <div class="loading-state">
        <div class="loading-spinner"></div>
        <p class="loading-text">Cargando detalle del pedido...</p>
      </div>
    }

    <!-- Error State -->
    @if (error && !loading) {
      <div class="error-state">
        <i class="fas fa-exclamation-circle error-icon"></i>
        <h3 class="error-title">¡Ups! Algo salió mal</h3>
        <p class="error-message">{{ error }}</p>
      </div>
    }

    <!-- Pedido Content -->
    @if (!loading && pedido) {
      <div class="pedido-content">
        <!-- Main Card -->
        <div class="pedido-main-card">
          <!-- Header con Estado y Tipo -->
          <div class="pedido-status-bar">
            <div
              class="status-badge"
              [class]="'status-badge--' + getEstadoClass(pedido.estadoPedido || '')"
            >
              <i [class]="'fas ' + getEstadoIcon(pedido.estadoPedido || '')"></i>
              <span>{{ getEstadoLabel(pedido.estadoPedido || '') }}</span>
            </div>
            <div class="tipo-badge" [class.tipo-badge--delivery]="pedido.delivery">
              <i [class]="pedido.delivery ? 'fas fa-shipping-fast' : 'fas fa-store'"></i>
              <span>{{ pedido.delivery ? 'Domicilio' : 'En Restaurante' }}</span>
            </div>
          </div>

          <!-- Información General -->
          <div class="pedido-info-grid">
            <div class="info-card">
              <i class="fas fa-calendar-alt info-card-icon"></i>
              <div class="info-card-content">
                <span class="info-card-label">Fecha del pedido</span>
                <span class="info-card-value">{{ pedido.fechaPedido | formatDate: 'date' }}</span>
              </div>
            </div>
            <div class="info-card">
              <i class="fas fa-clock info-card-icon"></i>
              <div class="info-card-content">
                <span class="info-card-label">Hora</span>
                <span class="info-card-value">{{ pedido.horaPedido | formatDate: 'time' }}</span>
              </div>
            </div>
            <div class="info-card">
              <i class="fas fa-credit-card info-card-icon"></i>
              <div class="info-card-content">
                <span class="info-card-label">Método de pago</span>
                <span class="info-card-value">{{ pedido.metodoPago || 'No especificado' }}</span>
              </div>
            </div>
          </div>

          <!-- Productos -->
          <div class="productos-section">
            <h3 class="productos-title">
              <i class="fas fa-shopping-bag"></i>
              Productos de tu pedido
            </h3>

            <div class="productos-lista">
              @for (prod of pedido.productos; track $index) {
                <div class="producto-item">
                  <div class="producto-info">
                    <div class="producto-nombre">
                      <i class="fas fa-utensils producto-icon"></i>
                      <span>{{ prod.NOMBRE || prod.nombre }}</span>
                    </div>
                    <div class="producto-detalles">
                      <span class="producto-cantidad">
                        <i class="fas fa-times"></i>
                        {{ prod.CANTIDAD || prod.cantidad }}
                      </span>
                      <span class="producto-precio-unitario">
                        ${{ prod.PRECIO_UNITARIO || prod.precio || 0 | number: '1.0-0' }} c/u
                      </span>
                    </div>
                  </div>
                  <div class="producto-subtotal">
                    ${{
                      prod.SUBTOTAL ??
                        (prod.PRECIO_UNITARIO || prod.precio || 0) *
                          (prod.CANTIDAD || prod.cantidad || 1) | number: '1.0-0'
                    }}
                  </div>
                </div>
              }
            </div>
          </div>

          <!-- Total -->
          <div class="pedido-total-section">
            <div class="total-row">
              <span class="total-label">Total del pedido</span>
              <span class="total-value">${{ pedido.total | number: '1.0-0' }}</span>
            </div>
          </div>
        </div>
      </div>
    }
  </div>
</div>
